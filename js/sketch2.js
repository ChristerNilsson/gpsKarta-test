// Generated by CoffeeScript 2.5.1
var SCALE, VERSION, cx, cy, data, draw, f, img, index, initSpeaker, mapName, messages, preload, released, say, setTimer, setup, speaker, start, startX, startY, state, timer, touchEnded, touchMoved, touchStarted;

VERSION = 100;

released = true;

mapName = ""; // t ex skarpnÃ¤ck

start = new Date();

state = 0; // 0=uninitialized 1=normal 2=info

data = null;

img = null;

startX = 0;

startY = 0;

messages = [];

index = 0;

speaker = null;

timer = null;

[cx, cy] = [
  0,
  0 // center (image coordinates)
];

SCALE = 1;

preload = function() {
  mapName = "2023-SommarS";
  return loadJSON(`data/${mapName}.json`, function(json) {
    var control, key, ref;
    data = json;
    ref = data.controls;
    for (key in ref) {
      control = ref[key];
      control.push("");
      control.push(0);
      control.push(0);
    }
    return img = loadImage("data/" + data.map);
  });
};

setup = function() {
  var canvas;
  canvas = createCanvas(innerWidth - 0.0, innerHeight); //-0.5
  canvas.position(0, 0); // hides text field used for clipboard copy.
  SCALE = data.scale;
  [cx, cy] = [img.width / 2, img.height / 2];
  return setTimer(function() {
    return 1000;
  });
};

draw = function() {
  var i, j, len, ref, results, x, y;
  background(0, 255, 0);
  if (state === 0) {
    textSize(100);
    textAlign(CENTER, CENTER);
    x = width / 2;
    y = height / 2;
    text(mapName, x, y - 100);
    text('Version: ' + VERSION, x, y);
    text("Click to continue!", x, y + 200);
    return;
  }
  if (state === 1) {
    start = new Date();
    push();
    translate(width / 2, height / 2);
    scale(SCALE);
    image(img, round(-cx), round(-cy));
    pop();
    textSize(20);
    messages.push(round(frameRate()));
    ref = range(messages.length);
    //if messages.length > 50 then messages.shift()
    results = [];
    for (j = 0, len = ref.length; j < len; j++) {
      i = ref[j];
      if (i < messages.length - 50) {
        continue;
      }
      results.push(text(messages[i], 50, 20 + 20 * (i % 50)));
    }
    return results;
  }
};

touchStarted = function(event) {
  event.preventDefault();
  if (!released) {
    return;
  }
  //speed = 1
  released = false;
  startX = mouseX;
  startY = mouseY;
  return false;
};

touchMoved = function(event) {
  event.preventDefault();
  if (state === 1) {
    cx += (startX - mouseX) / SCALE;
    cy += (startY - mouseY) / SCALE;
    startX = mouseX;
    startY = mouseY;
  }
  return false;
};

touchEnded = function(event) {
  event.preventDefault();
  if (released) {
    return;
  }
  initSpeaker();
  released = true;
  if (state === 0 || state === 2) {
    state = 1;
    return false;
  }
  return false;
};

initSpeaker = function() {
  speaker = new SpeechSynthesisUtterance();
  speaker.voiceURI = "native";
  speaker.volume = 1;
  speaker.rate = 1.0;
  speaker.pitch = 0;
  speaker.text = '';
  return speaker.lang = 'en-GB';
};

f = () => {
  say(index);
  console.log(index);
  index += 1;
  return setTimeout(f, 1000);
};

setTimer = function(ms) {
  return setTimeout(f, ms);
};

say = function(m) {
  if (speaker === null) {
    return;
  }
  speechSynthesis.cancel();
  speaker.text = m;
  return speechSynthesis.speak(speaker);
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoMi5qcyIsInNvdXJjZVJvb3QiOiIuLiIsInNvdXJjZXMiOlsiY29mZmVlXFxza2V0Y2gyLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsSUFBQSxLQUFBLEVBQUEsT0FBQSxFQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLEtBQUEsRUFBQSxXQUFBLEVBQUEsT0FBQSxFQUFBLFFBQUEsRUFBQSxPQUFBLEVBQUEsUUFBQSxFQUFBLEdBQUEsRUFBQSxRQUFBLEVBQUEsS0FBQSxFQUFBLE9BQUEsRUFBQSxLQUFBLEVBQUEsTUFBQSxFQUFBLE1BQUEsRUFBQSxLQUFBLEVBQUEsS0FBQSxFQUFBLFVBQUEsRUFBQSxVQUFBLEVBQUE7O0FBQUEsT0FBQSxHQUFVOztBQUVWLFFBQUEsR0FBVzs7QUFDWCxPQUFBLEdBQVUsR0FIVjs7QUFLQSxLQUFBLEdBQVEsSUFBSSxJQUFKLENBQUE7O0FBRVIsS0FBQSxHQUFRLEVBUFI7O0FBU0EsSUFBQSxHQUFPOztBQUVQLEdBQUEsR0FBTTs7QUFFTixNQUFBLEdBQVM7O0FBQ1QsTUFBQSxHQUFTOztBQUVULFFBQUEsR0FBVzs7QUFDWCxLQUFBLEdBQVE7O0FBRVIsT0FBQSxHQUFVOztBQUNWLEtBQUEsR0FBUTs7QUFFUixDQUFDLEVBQUQsRUFBSSxFQUFKLENBQUEsR0FBVTtFQUFDLENBQUQ7RUFBRyxDQUFIOzs7QUFDVixLQUFBLEdBQVE7O0FBRVIsT0FBQSxHQUFVLFFBQUEsQ0FBQSxDQUFBO0VBQ1QsT0FBQSxHQUFVO1NBQ1YsUUFBQSxDQUFTLENBQUEsS0FBQSxDQUFBLENBQVEsT0FBUixDQUFBLEtBQUEsQ0FBVCxFQUFpQyxRQUFBLENBQUMsSUFBRCxDQUFBO0FBQ2xDLFFBQUEsT0FBQSxFQUFBLEdBQUEsRUFBQTtJQUFFLElBQUEsR0FBTztBQUNQO0lBQUEsS0FBQSxVQUFBOztNQUNDLE9BQU8sQ0FBQyxJQUFSLENBQWEsRUFB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QVBZOztBQVNiLFVBQUEsR0FBYSxRQUFBLENBQUMsS0FBRCxDQUFBO0VBQ1osS0FBSyxDQUFDLGNBQU4sQ0FBQTtFQUNBLElBQUcsUUFBSDtBQUFpQixXQUFqQjs7RUFDQSxXQUFBLENBQUE7RUFDQSxRQUFBLEdBQVc7RUFDWCxJQUFHLFVBQVUsS0FBVixVQUFZLENBQWY7SUFDQyxLQUFBLEdBQVE7QUFDUixXQUFPLE1BRlI7O1NBR0E7QUFSWTs7QUFVYixXQUFBLEdBQWMsUUFBQSxDQUFBLENBQUE7RUFDYixPQUFBLEdBQVUsSUFBSSx3QkFBSixDQUFBO0VBQ1YsT0FBTyxDQUFDLFFBQVIsR0FBbUI7RUFDbkIsT0FBTyxDQUFDLE1BQVIsR0FBaUI7RUFDakIsT0FBTyxDQUFDLElBQVIsR0FBZTtFQUNmLE9BQU8sQ0FBQyxLQUFSLEdBQWdCO0VBQ2hCLE9BQU8sQ0FBQyxJQUFSLEdBQWU7U0FDZixPQUFPLENBQUMsSUFBUixHQUFlO0FBUEY7O0FBU2QsQ0FBQSxHQUFJLENBQUEsQ0FBQSxHQUFBO0VBQ0gsR0FBQSxDQUFJLEtBQUo7RUFDQSxPQUFPLENBQUMsR0FBUixDQUFZLEtBQVo7RUFDQSxLQUFBLElBQVM7U0FDVCxVQUFBLENBQVcsQ0FBWCxFQUFhLElBQWI7QUFKRzs7QUFNSixRQUFBLEdBQVcsUUFBQSxDQUFDLEVBQUQsQ0FBQTtTQUFRLFVBQUEsQ0FBVyxDQUFYLEVBQWEsRUFBYjtBQUFSOztBQUVYLEdBQUEsR0FBTSxRQUFBLENBQUMsQ0FBRCxDQUFBO0VBQ0wsSUFBRyxPQUFBLEtBQVcsSUFBZDtBQUF3QixXQUF4Qjs7RUFDQSxlQUFlLENBQUMsTUFBaEIsQ0FBQTtFQUNBLE9BQU8sQ0FBQyxJQUFSLEdBQWU7U0FDZixlQUFlLENBQUMsS0FBaEIsQ0FBc0IsT0FBdEI7QUFKSyIsInNvdXJjZXNDb250ZW50IjpbIlZFUlNJT04gPSAxMDBcdFxyXG5cclxucmVsZWFzZWQgPSB0cnVlXHJcbm1hcE5hbWUgPSBcIlwiICMgdCBleCBza2FycG7DpGNrXHJcblxyXG5zdGFydCA9IG5ldyBEYXRlKClcclxuXHJcbnN0YXRlID0gMCAjIDA9dW5pbml0aWFsaXplZCAxPW5vcm1hbCAyPWluZm9cclxuXHJcbmRhdGEgPSBudWxsXHJcblxyXG5pbWcgPSBudWxsXHJcblxyXG5zdGFydFggPSAwXHJcbnN0YXJ0WSA9IDBcclxuXHJcbm1lc3NhZ2VzID0gW11cclxuaW5kZXggPSAwXHJcblxyXG5zcGVha2VyID0gbnVsbFxyXG50aW1lciA9IG51bGxcclxuXHJcbltjeCxjeV0gPSBbMCwwXSAjIGNlbnRlciAoaW1hZ2UgY29vcmRpbmF0ZXMpXHJcblNDQUxFID0gMVxyXG5cclxucHJlbG9hZCA9IC0+XHJcblx0bWFwTmFtZSA9IFwiMjAyMy1Tb21tYXJTXCJcclxuXHRsb2FkSlNPTiBcImRhdGEvI3ttYXBOYW1lfS5qc29uXCIsIChqc29uKSAtPlxyXG5cdFx0ZGF0YSA9IGpzb25cclxuXHRcdGZvciBrZXksY29udHJvbCBvZiBkYXRhLmNvbnRyb2xzXHJcblx0XHRcdGNvbnRyb2wucHVzaCBcIlwiXHJcblx0XHRcdGNvbnRyb2wucHVzaCAwXHJcblx0XHRcdGNvbnRyb2wucHVzaCAwXHJcblx0XHRpbWcgPSBsb2FkSW1hZ2UgXCJkYXRhL1wiICsgZGF0YS5tYXBcclxuXHJcbnNldHVwID0gLT5cclxuXHRjYW52YXMgPSBjcmVhdGVDYW52YXMgaW5uZXJXaWR0aC0wLjAsIGlubmVySGVpZ2h0ICMtMC41XHJcblx0Y2FudmFzLnBvc2l0aW9uIDAsMCAjIGhpZGVzIHRleHQgZmllbGQgdXNlZCBmb3IgY2xpcGJvYXJkIGNvcHkuXHJcblxyXG5cdFNDQUxFID0gZGF0YS5zY2FsZVxyXG5cclxuXHRbY3gsY3ldID0gW2ltZy53aWR0aC8yLGltZy5oZWlnaHQvMl1cclxuXHJcblx0c2V0VGltZXIgLT4gMTAwMFxyXG5cclxuZHJhdyA9IC0+XHJcblxyXG5cdGJhY2tncm91bmQgMCwyNTUsMFxyXG5cdGlmIHN0YXRlID09IDAgXHJcblx0XHR0ZXh0U2l6ZSAxMDBcclxuXHRcdHRleHRBbGlnbiBDRU5URVIsQ0VOVEVSXHJcblx0XHR4ID0gd2lkdGgvMlxyXG5cdFx0eSA9IGhlaWdodC8yIFxyXG5cdFx0dGV4dCBtYXBOYW1lLCB4LHktMTAwXHJcblx0XHR0ZXh0ICdWZXJzaW9uOiAnK1ZFUlNJT04sIHgseVxyXG5cdFx0dGV4dCBcIkNsaWNrIHRvIGNvbnRpbnVlIVwiLCB4LHkrMjAwXHJcblx0XHRyZXR1cm5cclxuXHJcblx0aWYgc3RhdGUgPT0gMVxyXG5cdFx0c3RhcnQgPSBuZXcgRGF0ZSgpXHJcblx0XHRwdXNoKClcclxuXHRcdHRyYW5zbGF0ZSB3aWR0aC8yLCBoZWlnaHQvMlxyXG5cdFx0c2NhbGUgU0NBTEVcclxuXHRcdGltYWdlIGltZywgcm91bmQoLWN4KSxyb3VuZCgtY3kpXHJcblx0XHRwb3AoKVxyXG5cdFx0dGV4dFNpemUgMjBcclxuXHRcdG1lc3NhZ2VzLnB1c2ggcm91bmQgZnJhbWVSYXRlKClcclxuXHRcdCNpZiBtZXNzYWdlcy5sZW5ndGggPiA1MCB0aGVuIG1lc3NhZ2VzLnNoaWZ0KClcclxuXHRcdGZvciBpIGluIHJhbmdlIG1lc3NhZ2VzLmxlbmd0aFxyXG5cdFx0XHRpZiBpIDwgbWVzc2FnZXMubGVuZ3RoIC0gNTAgdGhlbiBjb250aW51ZVxyXG5cdFx0XHR0ZXh0IG1lc3NhZ2VzW2ldLCA1MCwyMCArIDIwKihpICUgNTApXHJcblxyXG50b3VjaFN0YXJ0ZWQgPSAoZXZlbnQpIC0+XHJcblx0ZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG5cdGlmIG5vdCByZWxlYXNlZCB0aGVuIHJldHVyblxyXG5cdCNzcGVlZCA9IDFcclxuXHRyZWxlYXNlZCA9IGZhbHNlXHJcblx0c3RhcnRYID0gbW91c2VYXHJcblx0c3RhcnRZID0gbW91c2VZXHJcblx0ZmFsc2VcclxuXHJcbnRvdWNoTW92ZWQgPSAoZXZlbnQpIC0+XHJcblx0ZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG5cdGlmIHN0YXRlID09IDFcclxuXHRcdGN4ICs9IChzdGFydFggLSBtb3VzZVgpL1NDQUxFXHJcblx0XHRjeSArPSAoc3RhcnRZIC0gbW91c2VZKS9TQ0FMRVxyXG5cdFx0c3RhcnRYID0gbW91c2VYXHJcblx0XHRzdGFydFkgPSBtb3VzZVlcclxuXHRmYWxzZVxyXG5cclxudG91Y2hFbmRlZCA9IChldmVudCkgLT5cclxuXHRldmVudC5wcmV2ZW50RGVmYXVsdCgpXHJcblx0aWYgcmVsZWFzZWQgdGhlbiByZXR1cm5cclxuXHRpbml0U3BlYWtlcigpIFxyXG5cdHJlbGVhc2VkID0gdHJ1ZVxyXG5cdGlmIHN0YXRlIGluIFswLDJdXHJcblx0XHRzdGF0ZSA9IDFcclxuXHRcdHJldHVybiBmYWxzZVxyXG5cdGZhbHNlXHJcblxyXG5pbml0U3BlYWtlciA9IC0+XHJcblx0c3BlYWtlciA9IG5ldyBTcGVlY2hTeW50aGVzaXNVdHRlcmFuY2UoKVxyXG5cdHNwZWFrZXIudm9pY2VVUkkgPSBcIm5hdGl2ZVwiXHJcblx0c3BlYWtlci52b2x1bWUgPSAxXHJcblx0c3BlYWtlci5yYXRlID0gMS4wXHJcblx0c3BlYWtlci5waXRjaCA9IDBcclxuXHRzcGVha2VyLnRleHQgPSAnJyBcclxuXHRzcGVha2VyLmxhbmcgPSAnZW4tR0InXHJcblxyXG5mID0gKCkgPT5cclxuXHRzYXkgaW5kZXhcclxuXHRjb25zb2xlLmxvZyBpbmRleFxyXG5cdGluZGV4ICs9IDFcclxuXHRzZXRUaW1lb3V0IGYsMTAwMFxyXG5cclxuc2V0VGltZXIgPSAobXMpIC0+IHNldFRpbWVvdXQgZixtc1xyXG5cclxuc2F5ID0gKG0pIC0+XHJcblx0aWYgc3BlYWtlciA9PSBudWxsIHRoZW4gcmV0dXJuXHJcblx0c3BlZWNoU3ludGhlc2lzLmNhbmNlbCgpXHJcblx0c3BlYWtlci50ZXh0ID0gbVxyXG5cdHNwZWVjaFN5bnRoZXNpcy5zcGVhayBzcGVha2VyXHJcbiJdfQ==
//# sourceURL=c:\github\gpsKarta-test\coffee\sketch2.coffee